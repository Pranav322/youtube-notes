services:
  api:
    build: ./backend
    restart: always
    ports:
      - "8000:8000"
    env_file:
      - .env

  web:
    build:
      context: ./frontend
      args:
        NEXT_PUBLIC_API_URL: /api
    restart: always
    depends_on:
      - api
    ports:
      - "3000:3000"
    environment:
      # In Docker, 'api' is the hostname of the backend service
      # But since Next.js runs client-side fetch in the browser, 
      # the browser needs to reach localhost:8000 (if running locally)
      # or your VPS IP/Domain (if deployed).
      # For local testing via Docker Compose:
      NEXT_PUBLIC_API_URL: /api
